(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e3db4042"],{"333d":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[s("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},i=[];s("c5f6");Math.easeInOutQuad=function(e,t,s,a){return e/=a/2,e<1?s/2*e*e+t:(e--,-s/2*(e*(e-2)-1)+t)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function r(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(e,t,s){var a=o(),i=e-a,l=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=l;var o=Math.easeInOutQuad(c,a,i,t);r(o),c<t?n(e):s&&"function"===typeof s&&s()};u()}var c={name:"Pagination",props:{total:{required:!0,type:Number},current:{type:Number,default:1},size:{type:Number,default:10},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.current},set:function(e){this.$emit("update:current",e)}},pageSize:{get:function(){return this.size},set:function(e){this.$emit("update:size",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{current:this.currentPage,size:e}),this.autoScroll&&l(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{current:e,size:this.pageSize}),this.autoScroll&&l(0,800)}}},u=c,d=(s("6467"),s("2877")),p=Object(d["a"])(u,a,i,!1,null,"5599f724",null);t["default"]=p.exports},3579:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"查看详情",visible:e.dialogProcessDetailVisibleInChild,fullscreen:""},on:{"update:visible":function(t){e.dialogProcessDetailVisibleInChild=t}}},[s("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"过程意见",name:"comments"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.comments,border:"",fit:"","highlight-current-row":"","cell-style":{padding:"3px"}}},[s("el-table-column",{attrs:{label:"任务节点",prop:"taskName",align:"center",width:"165px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.taskName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作类型",prop:"typeDesc",align:"center",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.typeDesc))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"参与人",prop:"userName",align:"center",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.userName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"时间",prop:"time",align:"center",width:"165px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.time))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"意见",prop:"fullMessage",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.fullMessage))])]}}])})],1)],1),e._v(" "),s("el-tab-pane",{attrs:{label:"流程表单",name:"processIntanceForm"}},[e.generateStartFormVisible?s("div",[s("fm-generate-form",{ref:"generateStartForm",attrs:{data:e.startFormJson,value:e.variables}})],1):e._e(),e._v(" "),e.showBusinessKey?s("el-form",{attrs:{"label-width":"100px"}},[s("el-form-item",{attrs:{label:"业务主键Key:"}},[s("el-input",{attrs:{disabled:""},model:{value:e.businessKey,callback:function(t){e.businessKey=t},expression:"businessKey"}})],1)],1):e._e(),e._v(" "),e.generateStartFormVisible||e.showBusinessKey?e._e():s("div",[e._v("\n                无\n            ")])],1),e._v(" "),s("el-tab-pane",{attrs:{label:"流程图",name:"processIntanceImage"}},[s("el-scrollbar",[s("img",{attrs:{src:e.imagePath,alt:"流程图"}})])],1)],1)],1)},i=[],n=(s("7f7f"),s("0fea")),r=s("5f87"),o={name:"ProcessDetail",props:{visible:{type:Boolean,default:function(){return!1}},processInstanceId:{type:String,default:function(){return""}}},computed:{dialogProcessDetailVisibleInChild:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},data:function(){return{activeName:"comments",comments:[],imagePath:"",isShowProcessInstanceForm:!1,generateStartFormVisible:!1,startFormJson:void 0,variables:void 0,showBusinessKey:!1,businessKey:void 0}},created:function(){this.init()},methods:{init:function(){this.listComments()},handleClick:function(e,t){"processIntanceForm"==e.name?this.showProcessInstanceForm():"processIntanceImage"==e.name&&this.showImage()},showProcessInstanceForm:function(){var e=this;this.isShowProcessInstanceForm||Object(n["c"])("/flowable/processInstance/formData",{processInstanceId:this.processInstanceId}).then((function(t){var s=t.data;e.showBusinessKey=s.showBusinessKey,e.businessKey=s.businessKey,s&&s.renderedStartForm&&(e.startFormJson=JSON.parse(s.renderedStartForm),e.variables=JSON.parse(s.variables.processInstanceFormData),e.generateStartFormVisible=!0),e.isShowProcessInstanceForm=!0}))},listComments:function(){var e=this;Object(n["c"])("/flowable/processInstance/comments",{processInstanceId:this.processInstanceId}).then((function(t){var s=t.data;e.comments=s}))},showImage:function(){this.imagePath||(this.imagePath="".concat("/zjmzxfzhl")+"/flowable/processInstanceImage?processInstanceId="+this.processInstanceId+"&access_token="+Object(r["a"])()+"&time="+new Date)}}},l=o,c=s("2877"),u=Object(c["a"])(l,a,i,!1,null,null,null);t["default"]=u.exports},6467:function(e,t,s){"use strict";var a=s("c45a"),i=s.n(a);i.a},bf7e:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("div",{staticClass:"filter-container"},[s("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"流程实例ID"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.btnQuery(t)}},model:{value:e.listQuery.processInstanceId,callback:function(t){e.$set(e.listQuery,"processInstanceId",t)},expression:"listQuery.processInstanceId"}}),e._v(" "),s("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"任务名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.btnQuery(t)}},model:{value:e.listQuery.taskName,callback:function(t){e.$set(e.listQuery,"taskName",t)},expression:"listQuery.taskName"}}),e._v(" "),s("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"业务主键Key"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.btnQuery(t)}},model:{value:e.listQuery.processInstanceBusinessKey,callback:function(t){e.$set(e.listQuery,"processInstanceBusinessKey",t)},expression:"listQuery.processInstanceBusinessKey"}}),e._v(" "),s("el-date-picker",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{"value-format":"yyyy-MM-dd",placeholder:"到期日开始",type:"date"},model:{value:e.listQuery.dueDateAfter,callback:function(t){e.$set(e.listQuery,"dueDateAfter",t)},expression:"listQuery.dueDateAfter"}}),e._v(" "),s("el-date-picker",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{"value-format":"yyyy-MM-dd",placeholder:"到期日结束",type:"date"},model:{value:e.listQuery.dueDateBefore,callback:function(t){e.$set(e.listQuery,"dueDateBefore",t)},expression:"listQuery.dueDateBefore"}}),e._v(" "),s("el-dropdown",{staticClass:"filter-item",attrs:{"split-button":"",type:"primary"},on:{click:e.btnQuery}},[s("i",{staticClass:"el-icon-search el-icon--left"}),e._v("查询\n            "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{icon:"el-icon-zoom-out"},nativeOn:{click:function(t){return e.btnReset(t)}}},[e._v("重置")])],1)],1)],1),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.records,border:"",fit:"","highlight-current-row":"","cell-style":{padding:"3px"}}},[s("el-table-column",{attrs:{label:"流程实例名称",prop:"processInstanceName",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.processInstanceName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"任务名称",prop:"name",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"开始时间",prop:"createTime",align:"center",width:"165px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.createTime))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"到期日期",prop:"dueDate",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.dueDate))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"所有人",prop:"owner",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.owner))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"执行人",prop:"assignee",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.assignee))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[s("el-dropdown",[s("span",{staticClass:"el-dropdown-link"},[e._v("操作"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{icon:"el-icon-view"},nativeOn:{click:function(t){return e.btnView(a.processInstanceId)}}},[e._v("查看详情\n                        ")]),e._v(" "),null==a.assignee||""==a.assignee?s("el-dropdown-item",{attrs:{icon:"el-icon-edit",divided:""},nativeOn:{click:function(t){return e.btnClaim(a)}}},[e._v("认领\n                        ")]):e._e(),e._v(" "),a.assignee===e.$store.getters.sysUser.userId&&null==a.endTime?s("el-dropdown-item",{attrs:{icon:"el-icon-edit",divided:""},nativeOn:{click:function(t){return e.btnUnclaim(a)}}},[e._v("取消认领\n                        ")]):e._e(),e._v(" "),null==a.endTime&&null!=a.assignee&&""!=a.assignee?s("el-dropdown-item",{attrs:{icon:"el-icon-edit",divided:""},nativeOn:{click:function(t){return e.btnExcuteTask(a)}}},[e._v("执行\n                        ")]):e._e()],1)],1)]}}])})],1),e._v(" "),s("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,current:e.listQuery.current,size:e.listQuery.size},on:{"update:current":function(t){return e.$set(e.listQuery,"current",t)},"update:size":function(t){return e.$set(e.listQuery,"size",t)},pagination:e.list}}),e._v(" "),e.dialogExcuteTaskVisible?s("execute-task",{attrs:{visible:e.dialogExcuteTaskVisible,executeTaskId:e.executeTaskId},on:{"update:visible":function(t){e.dialogExcuteTaskVisible=t},executeTaskFinished:e.list}}):e._e(),e._v(" "),e.dialogViewVisible?s("process-detail",{attrs:{visible:e.dialogViewVisible,processInstanceId:e.processInstanceId},on:{"update:visible":function(t){e.dialogViewVisible=t}}}):e._e()],1)},i=[],n=s("333d"),r=s("0fea"),o=s("5c96"),l=s("f357"),c=s("3579"),u={name:"FlowableTaskTodo",components:{Pagination:n["default"],ExecuteTask:l["default"],ProcessDetail:c["default"]},data:function(){return{dicts:[],records:null,selectedRecords:[],total:0,listQuery:{current:1,size:10,processInstanceId:void 0,taskName:void 0,processInstanceBusinessKey:void 0,dueDateAfter:void 0,dueDateBefore:void 0},dialogExcuteTaskVisible:!1,formJson:void 0,executeTaskId:"",processInstanceId:"",dialogViewVisible:!1}},beforeCreate:function(){var e=this;this.getDicts("trueOrFalse").then((function(t){var s=t.data;e.dicts=s}))},created:function(){this.list()},methods:{list:function(){var e=this;Object(r["c"])("/flowable/task/listTodo",this.listQuery).then((function(t){var s=t.data;e.records=s.records,e.total=s.total}))},btnQuery:function(){this.listQuery.current=1,this.list()},btnReset:function(){this.listQuery={current:1,size:10,processInstanceId:void 0,taskName:void 0,processInstanceBusinessKey:void 0,dueDateAfter:void 0,dueDateBefore:void 0},this.list()},btnClaim:function(e){var t=this;Object(r["e"])("/flowable/task/claim",{taskId:e.id}).then((function(e){var s=e.msg;o["Message"].success(s),t.list()}))},btnUnclaim:function(e){var t=this;Object(r["e"])("/flowable/task/unclaim",{taskId:e.id}).then((function(e){var s=e.msg;o["Message"].success(s),t.list()}))},btnExcuteTask:function(e){this.executeTaskId=e.id,this.dialogExcuteTaskVisible=!0},btnView:function(e){this.processInstanceId=e,this.dialogViewVisible=!0}}},d=u,p=s("2877"),f=Object(p["a"])(d,a,i,!1,null,null,null);t["default"]=f.exports},c45a:function(e,t,s){},c4f3:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"选择用户",visible:e.visibleInChild,"append-to-body":e.appendToBody,fullscreen:"","before-close":e.close},on:{"update:visible":function(t){e.visibleInChild=t}}},[s("div",{staticClass:"el-dialog-body-custom-height"},[s("el-row",{attrs:{gutter:5}},[s("el-col",{attrs:{span:8}},[s("div",[s("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:"请输入过滤条件"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),s("el-tree",{ref:"_selectOrgTree",staticClass:"filter-tree",attrs:{data:e.treeData,"node-key":"id",props:e.defaultProps,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}})],1)]),e._v(" "),s("el-col",{attrs:{span:16}},[s("div",[s("div",{staticClass:"filter-container"},[s("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"用户ID"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.btnQuery(t)}},model:{value:e.listQuery.userId,callback:function(t){e.$set(e.listQuery,"userId",t)},expression:"listQuery.userId"}}),e._v(" "),s("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"用户姓名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.btnQuery(t)}},model:{value:e.listQuery.userName,callback:function(t){e.$set(e.listQuery,"userName",t)},expression:"listQuery.userName"}}),e._v(" "),s("el-dropdown",{staticClass:"filter-item",attrs:{"split-button":"",type:"primary"},on:{click:e.btnQuery}},[s("i",{staticClass:"el-icon-search el-icon--left"}),e._v("查询\n                            "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{icon:"el-icon-zoom-out"},nativeOn:{click:function(t){return e.btnReset(t)}}},[e._v("重置")])],1)],1)],1),e._v(" "),s("el-table",{ref:"_sysUserTable",staticStyle:{width:"100%"},attrs:{data:e.records,border:"",fit:"","highlight-current-row":"","cell-style":{padding:"3px"}},on:{"selection-change":e.selectionChange,"row-click":e.rowClick}},[e.multipleSelect?s("el-table-column",{attrs:{type:"selection",align:"center"}}):e._e(),e._v(" "),s("el-table-column",{attrs:{label:"用户ID",prop:"userId",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.userId))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"用户姓名",prop:"userName",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.userName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"所属机构ID",prop:"orgId",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.orgId))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"所属机构",prop:"orgName",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.orgName))])]}}])})],1),e._v(" "),s("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,current:e.listQuery.current,size:e.listQuery.size},on:{"update:current":function(t){return e.$set(e.listQuery,"current",t)},"update:size":function(t){return e.$set(e.listQuery,"size",t)},pagination:e.listSysUsers}})],1)])],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{icon:"el-icon-close"},on:{click:function(t){e.visibleInChild=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{icon:"el-icon-check",type:"primary"},on:{click:e.confirm}},[e._v("确定")])],1)])},i=[],n=s("333d"),r=s("0fea"),o=s("5c96"),l={name:"SelectUser",components:{Pagination:n["default"]},props:{visible:{type:Boolean,default:!1},multipleSelect:{type:Boolean,default:!1},type:{type:String,default:""},appendToBody:{type:Boolean,default:!1}},data:function(){return{filterText:"",treeData:[],defaultProps:{children:"children",label:"label",isLeaf:"isLeaf",data:"data"},records:[],total:0,selectedRecords:[],selectedRecord:{},listQuery:{current:1,size:10,userId:void 0,userName:void 0,orgId:void 0},currOrgId:""}},watch:{filterText:function(e){this.$refs._selectOrgTree.filter(e)}},computed:{visibleInChild:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},methods:{close:function(){this.visibleInChild=!1},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},getTreeData:function(){var e=this;Object(r["c"])("/sys/org/getSelectTreeData",{type:this.type}).then((function(t){var s=t.data;e.treeData=s}))},handleNodeClick:function(e){this.currOrgId=e.id,this.listSysUsers()},listSysUsers:function(){var e=this;this.listQuery.orgId=this.currOrgId,Object(r["c"])("/sys/user/listSelectUser",this.listQuery).then((function(t){var s=t.data;e.records=s.records,e.total=s.total}))},btnQuery:function(){this.listQuery.current=1,this.listSysUsers()},btnReset:function(){this.currOrgId="",this.listQuery={current:1,size:10,userId:void 0,userName:void 0,orgId:void 0},this.listSysUsers()},selectionChange:function(e){this.selectedRecords=e},rowClick:function(e){this.selectedRecord=e},confirm:function(){if(this.multipleSelect){if(!this.selectedRecords||0==this.selectedRecords.length)return void o["Message"].error("请先选择用户");this.$emit("selectUserFinished",this.selectedRecords)}else{if(!this.selectedRecord)return void o["Message"].error("请先选择用户");this.$emit("selectUserFinished",this.selectedRecord)}this.visibleInChild=!1}}},c=l,u=s("2877"),d=Object(u["a"])(c,a,i,!1,null,null,null);t["default"]=d.exports},db89:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"退回任务",visible:e.dialogTaskBackNodesInChild,appendToBody:!0,fullscreen:""},on:{"update:visible":function(t){e.dialogTaskBackNodesInChild=t}}},[s("el-radio-group",{on:{change:e.selectBackNode},model:{value:e.backNode,callback:function(t){e.backNode=t},expression:"backNode"}},e._l(e.backNodes,(function(t){return s("el-radio",{attrs:{border:"",label:t}},[e._v("\n            【"+e._s(t.nodeId)+"-"+e._s(t.nodeName)+"】"+e._s(t.userName)+"\n        ")])})),1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{icon:"el-icon-close"},on:{click:function(t){e.dialogTaskBackNodesInChild=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{icon:"el-icon-check",type:"primary"},on:{click:e.doConfirm}},[e._v("确定")])],1)],1)},i=[],n=s("0fea"),r=(s("5c96"),{name:"TaskBackNodes",props:{visible:{type:Boolean,default:function(){return!1}},executeTaskId:{type:String,default:function(){return""}}},computed:{dialogTaskBackNodesInChild:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},data:function(){return{backNode:"",backNodes:[]}},created:function(){this.initData()},methods:{initData:function(){var e=this;Object(n["c"])("/flowable/task/backNodes",{taskId:this.executeTaskId}).then((function(t){var s=t.data;e.backNodes=s,e.backNode=e.backNodes[0]}))},selectBackNode:function(e){this.backNode=e},doConfirm:function(){this.dialogTaskBackNodesInChild=!1,this.$emit("backTaskFinished",this.backNode)}}}),o=r,l=s("2877"),c=Object(l["a"])(o,a,i,!1,null,null,null);t["default"]=c.exports},f357:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"执行任务",visible:e.dialogExcuteTaskVisibleInChild,fullscreen:!1},on:{"update:visible":function(t){e.dialogExcuteTaskVisibleInChild=t}}},[s("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[e.generateTaskFormVisible?s("el-tab-pane",{attrs:{name:"taskForm",label:"任务表单"}},[s("fm-generate-form",{ref:"generateFormTask",attrs:{data:e.taskFormJson,value:e.taskFormData}})],1):e._e(),e._v(" "),s("el-tab-pane",{attrs:{name:"processInstanceForm",label:"流程表单(只读)"}},[e.generateStartFormVisible?s("fm-generate-form",{ref:"generateFormStart",attrs:{data:e.startFormJson,value:e.processInstanceFormData}}):e._e(),e._v(" "),e.showBusinessKey?s("el-form",{attrs:{"label-width":"100px"}},[s("el-form-item",{attrs:{label:"业务主键Key:"}},[s("el-input",{attrs:{disabled:""},model:{value:e.businessKey,callback:function(t){e.businessKey=t},expression:"businessKey"}})],1)],1):e._e(),e._v(" "),e.generateStartFormVisible||e.showBusinessKey?e._e():s("div",[e._v("\n                无\n            ")])],1)],1),e._v(" "),s("select-user",{ref:"selectUser",attrs:{visible:e.selectUserVisible,appendToBody:!0,multipleSelect:!1},on:{"update:visible":function(t){e.selectUserVisible=t},selectUserFinished:e.selectUserFinished}}),e._v(" "),e.dialogTaskBackNodesVisible?s("task-back-nodes",{attrs:{visible:e.dialogTaskBackNodesVisible,executeTaskId:e.executeTaskId},on:{"update:visible":function(t){e.dialogTaskBackNodesVisible=t},backTaskFinished:e.backTaskFinished}}):e._e(),e._v(" "),s("div",{staticClass:"dialog-footer",staticStyle:{padding:"0 15px 0 15px"},attrs:{slot:"footer"},slot:"footer"},[s("el-form",{attrs:{"label-width":"100px"}},[s("el-form-item",{attrs:{label:"意见:"}},[s("el-input",{attrs:{autosize:{minRows:2,maxRows:3},type:"textarea",placeholder:"请输入意见"},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1)],1),e._v(" "),s("el-button",{attrs:{icon:"el-icon-close"},on:{click:function(t){e.dialogExcuteTaskVisibleInChild=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{icon:"el-icon-check",type:"primary"},on:{click:e.doComplete}},[e._v("提交")]),e._v(" "),"admin"===e.$store.getters.sysUser.userId||e.$store.getters.sysUser.userId===e.startUserId?s("el-button",{attrs:{icon:"el-icon-close",type:"primary"},on:{click:e.doStop}},[e._v("终止")]):e._e(),e._v(" "),e.isInitiator?e._e():s("el-button",{attrs:{icon:"el-icon-user",type:"primary"},on:{click:e.doAssign}},[e._v("转办")]),e._v(" "),e.isInitiator?e._e():s("el-button",{attrs:{icon:"el-icon-user",type:"primary"},on:{click:e.doDelegate}},[e._v("委派")]),e._v(" "),e.isInitiator?e._e():s("el-button",{attrs:{icon:"el-icon-back",type:"primary"},on:{click:e.doBack}},[e._v("退回")])],1)],1)},i=[],n=s("0fea"),r=s("5c96"),o=s("c4f3"),l=s("0f95"),c=s("db89"),u={name:"ExecuteTask",components:{SelectUser:o["default"],TaskBackNodes:c["default"]},props:{visible:{type:Boolean,default:function(){return!1}},executeTaskId:{type:String,default:function(){return""}}},computed:{dialogExcuteTaskVisibleInChild:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},data:function(){return{activeName:"processInstanceForm",startFormKey:void 0,taskFormKey:void 0,startFormJson:void 0,taskFormJson:void 0,generateStartFormVisible:!1,generateTaskFormVisible:!1,taskFormData:void 0,showBusinessKey:!1,businessKey:void 0,processInstanceFormData:void 0,startUserId:"",isInitiator:!1,selectUserVisible:!1,selectUserType:"",message:"",dialogTaskBackNodesVisible:!1}},created:function(){this.initData()},methods:{initData:function(){var e=this;Object(n["c"])("/flowable/task/executeTaskData",{taskId:this.executeTaskId}).then((function(t){var s=t.data;e.startUserId=s.startUserId,e.showBusinessKey=s.showBusinessKey,e.businessKey=s.businessKey,e.startFormKey=s.startFormKey,e.taskFormKey=s.taskFormKey,e.isInitiator=s.isInitiator,s.renderedStartForm&&(e.startFormJson=JSON.parse(s.renderedStartForm),e.processInstanceFormData=JSON.parse(s.variables.processInstanceFormData),e.generateStartFormVisible=!0),s.renderedTaskForm&&(e.taskFormJson=JSON.parse(s.renderedTaskForm),e.startFormKey&&e.taskFormKey&&e.startFormKey==e.taskFormKey&&(e.taskFormData=JSON.parse(s.variables.processInstanceFormData)),e.generateTaskFormVisible=!0),e.generateTaskFormVisible&&(e.activeName="taskForm")}))},checkMessage:function(){if(!this.message||""===this.message)throw new l["a"]("请输入意见")},doComplete:function(){var e=this;this.checkMessage(),this.$refs.generateFormTask?this.$refs.generateFormTask.getData().then((function(t){if(t&&void 0!=t){var s=t;if(e.startFormKey&&e.taskFormKey&&e.startFormKey==e.taskFormKey){var a=JSON.stringify(t);s=Object.assign({processInstanceFormData:a},t)}return Object(n["e"])("/flowable/task/complete",{taskId:e.executeTaskId,message:e.message,isInitiator:e.isInitiator,values:s}).then((function(t){var s=t.msg;r["Message"].success(s),e.dialogExcuteTaskVisibleInChild=!1,e.$emit("executeTaskFinished")}))}})).catch((function(e){})):Object(n["e"])("/flowable/task/complete",{taskId:this.executeTaskId,message:this.message}).then((function(t){var s=t.msg;r["Message"].success(s),e.dialogExcuteTaskVisibleInChild=!1,e.$emit("executeTaskFinished")}))},doStop:function(){var e=this;this.checkMessage(),Object(n["e"])("/flowable/task/stopProcessInstance",{taskId:this.executeTaskId,message:this.message}).then((function(t){var s=t.msg;r["Message"].success(s),e.dialogExcuteTaskVisibleInChild=!1,e.$emit("executeTaskFinished")}))},doAssign:function(){this.checkMessage(),this.selectUserVisible=!0,this.selectUserType="assign",0==this.$refs.selectUser.treeData.length&&this.$refs.selectUser.getTreeData()},doDelegate:function(){this.checkMessage(),this.selectUserVisible=!0,this.selectUserType="delegate",0==this.$refs.selectUser.treeData.length&&this.$refs.selectUser.getTreeData()},selectUserFinished:function(e){var t=this;e&&0!=e.length?"assign"===this.selectUserType?Object(n["e"])("/flowable/task/assign",{taskId:this.executeTaskId,userId:e.userId,message:this.message}).then((function(e){var s=e.msg;r["Message"].success(s),t.selectUserVisible=!1,t.dialogExcuteTaskVisibleInChild=!1,t.$emit("executeTaskFinished")})):"delegate"===this.selectUserType&&Object(n["e"])("/flowable/task/delegate",{taskId:this.executeTaskId,userId:e.userId,message:this.message}).then((function(e){var s=e.msg;r["Message"].success(s),t.selectUserVisible=!1,t.dialogExcuteTaskVisibleInChild=!1,t.$emit("executeTaskFinished")})):r["Message"].error("请先选择用户")},doBack:function(){this.checkMessage(),this.dialogTaskBackNodesVisible=!0},backTaskFinished:function(e){var t=this;Object(n["e"])("/flowable/task/back",{taskId:this.executeTaskId,activityId:e.nodeId,activityName:e.nodeName,message:this.message}).then((function(e){var s=e.msg;r["Message"].success(s),t.dialogExcuteTaskVisibleInChild=!1,t.$emit("executeTaskFinished")}))}}},d=u,p=s("2877"),f=Object(p["a"])(d,a,i,!1,null,null,null);t["default"]=f.exports}}]);